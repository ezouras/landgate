stuff from d_one branch
